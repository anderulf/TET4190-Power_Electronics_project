## --------------------------
# Script used to find the optimal switching frequency.
# It takes inputted values from the inductor design algorithm. It also calculated the mosfet and diode losses.
# The average losses (inductor + mosfet + diode) for the range 20%-70% operation are plotted to find the switching combination
# of frequency and cable size in the inductor in which minimises the losses. 
# ---------------------------

%% Common constans
Vd=230*0.9;
V0=385;

D=1-(Vd/V0); %Duty cycle
I_D_avg_10=10; %average load current
I_D_avg_7=7; %average load current
I_D_avg_6=6; %average load current
I_D_avg_5=5; %average load current
I_D_avg_4=4; %average load current
I_D_avg_3=3; %average load current
I_D_avg_2=2; %average load current

total_mos_diode_losses_10=zeros(131,1);
total_s_loss_mos_di_10=zeros(131,1);

total_mos_diode_losses_7=zeros(131,1);
total_s_loss_mos_di_7=zeros(131,1);

total_mos_diode_losses_6=zeros(131,1);
total_s_loss_mos_di_6=zeros(131,1);

total_mos_diode_losses_5=zeros(131,1);
total_s_loss_mos_di_5=zeros(131,1);

total_mos_diode_losses_4=zeros(131,1);
total_s_loss_mos_di_4=zeros(131,1);

total_mos_diode_losses_3=zeros(131,1);
total_s_loss_mos_di_3=zeros(131,1);

total_mos_diode_losses_2=zeros(131,1);
total_s_loss_mos_di_2=zeros(131,1);

counter=1;

 %For 10A 
 E_sl_mosfet_sic_10=62.742+61.219;
 E_sl_diode_sic_10=-6.531+7.4021;
 
 %For 7A 
 E_sl_mosfet_sic_7=33.668+43.59;
 E_sl_diode_sic_7=-7.3708+7.7226;
 
 %For 6A 
 E_sl_mosfet_sic_6=25.42+36.48;
 E_sl_diode_sic_6=-7.3893+7.7711;
 
 %For 5A 
 E_sl_mosfet_sic_5=19.203+31.37;
 E_sl_diode_sic_5=-7.4823+7.8823;
 
 %For 4A 
 E_sl_mosfet_sic_4=14.94+27.418;
 E_sl_diode_sic_4=-7.6926+7.8167;
 
 %For 3A 
 E_sl_mosfet_sic_3=12.345+22.843;
 E_sl_diode_sic_3=-7.7165+8.0197;
 
 %For 2A 
 E_sl_mosfet_sic_2=11.48+19.36;
 E_sl_diode_sic_2=-7.88+7.9;


 frequencies=20000:1000:150000;
 
for fs=20000:1000:150000
    disp('----------------------------------------------------------')
    disp(fs)
    %switching losses P_sl_mos_diode (I= 10 Ampere)

    P_sl_mosfet_sic_10=E_sl_mosfet_sic_10*10^(-6)*fs;
    P_sl_diode_sic_10=E_sl_diode_sic_10*10^(-6)*fs; 
    
    P_sl_mosfet_sic_7=E_sl_mosfet_sic_7*10^(-6)*fs;
    P_sl_diode_sic_7=E_sl_diode_sic_7*10^(-6)*fs;
    
    P_sl_mosfet_sic_6=E_sl_mosfet_sic_6*10^(-6)*fs;
    P_sl_diode_sic_6=E_sl_diode_sic_6*10^(-6)*fs;
    
    P_sl_mosfet_sic_5=E_sl_mosfet_sic_5*10^(-6)*fs;
    P_sl_diode_sic_5=E_sl_diode_sic_5*10^(-6)*fs;
    
    P_sl_mosfet_sic_4=E_sl_mosfet_sic_4*10^(-6)*fs;
    P_sl_diode_sic_4=E_sl_diode_sic_4*10^(-6)*fs;
    
    P_sl_mosfet_sic_3=E_sl_mosfet_sic_3*10^(-6)*fs;
    P_sl_diode_sic_3=E_sl_diode_sic_3*10^(-6)*fs;
    
    P_sl_mosfet_sic_2=E_sl_mosfet_sic_2*10^(-6)*fs;
    P_sl_diode_sic_2=E_sl_diode_sic_2*10^(-6)*fs;
    

    %%Mosfet Sic
    r_mosfet_sic=0.0875673907; %Sic 
    
    %10A
    I_L_avg_10=(I_D_avg_10*0.81)/(1-D);
    I_L_rms_10=I_L_avg_10/0.9;
    I_mos_rms_10=I_L_rms_10*sqrt(1-(1-D)*(1/0.81));
    P_on_mos_sic_10=I_mos_rms_10^2*r_mosfet_sic;
    
    %7A
    I_L_avg_7=(I_D_avg_7*0.81)/(1-D);
    I_L_rms_7=I_L_avg_7/0.9;
    I_mos_rms_7=I_L_rms_7*sqrt(1-(1-D)*(1/0.81));
    P_on_mos_sic_7=I_mos_rms_7^2*r_mosfet_sic;
    
    %6A
    I_L_avg_6=(I_D_avg_6*0.81)/(1-D);
    I_L_rms_6=I_L_avg_6/0.9;
    I_mos_rms_6=I_L_rms_6*sqrt(1-(1-D)*(1/0.81));
    P_on_mos_sic_6=I_mos_rms_6^2*r_mosfet_sic;
    
    %5A
    I_L_avg_5=(I_D_avg_5*0.81)/(1-D);
    I_L_rms_5=I_L_avg_5/0.9;
    I_mos_rms_5=I_L_rms_5*sqrt(1-(1-D)*(1/0.81));
    P_on_mos_sic_5=I_mos_rms_5^2*r_mosfet_sic;
    
    %4A
    I_L_avg_4=(I_D_avg_4*0.81)/(1-D);
    I_L_rms_4=I_L_avg_4/0.9;
    I_mos_rms_4=I_L_rms_4*sqrt(1-(1-D)*(1/0.81));
    P_on_mos_sic_4=I_mos_rms_4^2*r_mosfet_sic;
    
    %3A
    I_L_avg_3=(I_D_avg_3*0.81)/(1-D);
    I_L_rms_3=I_L_avg_3/0.9;
    I_mos_rms_3=I_L_rms_3*sqrt(1-(1-D)*(1/0.81));
    P_on_mos_sic_3=I_mos_rms_3^2*r_mosfet_sic;
    
    %2A
    I_L_avg_2=(I_D_avg_2*0.81)/(1-D);
    I_L_rms_2=I_L_avg_2/0.9;
    I_mos_rms_2=I_L_rms_2*sqrt(1-(1-D)*(1/0.81));
    P_on_mos_sic_2=I_mos_rms_2^2*r_mosfet_sic;
    

    %%Diode Sic
    r_on_diode_sic=0.03585; %Si
    V_f_sic=0.8081; %Si
    
    %10A
    I_D_rms_10=I_L_rms_10*sqrt((1-D)*(1/0.81));
    P_on_diode_sic_10=V_f_sic*I_D_avg_10+r_on_diode_sic*I_D_rms_10^2;
   
    %7A
    I_D_rms_7=I_L_rms_7*sqrt((1-D)*(1/0.81));
    P_on_diode_sic_7=V_f_sic*I_D_avg_7+r_on_diode_sic*I_D_rms_7^2;
    
    %4A
    I_D_rms_4=I_L_rms_4*sqrt((1-D)*(1/0.81));
    P_on_diode_sic_4=V_f_sic*I_D_avg_4+r_on_diode_sic*I_D_rms_4^2;
   
    %2A
    I_D_rms_2=I_L_rms_2*sqrt((1-D)*(1/0.81));
    P_on_diode_sic_2=V_f_sic*I_D_avg_2+r_on_diode_sic*I_D_rms_2^2;
    
    %3A
    I_D_rms_3=I_L_rms_3*sqrt((1-D)*(1/0.81));
    P_on_diode_sic_3=V_f_sic*I_D_avg_3+r_on_diode_sic*I_D_rms_3^2;
    
    %5A
    I_D_rms_5=I_L_rms_5*sqrt((1-D)*(1/0.81));
    P_on_diode_sic_5=V_f_sic*I_D_avg_5+r_on_diode_sic*I_D_rms_5^2;
    
    %6A
    I_D_rms_6=I_L_rms_6*sqrt((1-D)*(1/0.81));
    P_on_diode_sic_6=V_f_sic*I_D_avg_6+r_on_diode_sic*I_D_rms_6^2;

    p_tot_mosfet_10=P_sl_mosfet_sic_10+P_on_mos_sic_10;
    p_tot_mosfet_7=P_sl_mosfet_sic_7+P_on_mos_sic_7;
    p_tot_mosfet_4=P_sl_mosfet_sic_4+P_on_mos_sic_4;
    p_tot_mosfet_2=P_sl_mosfet_sic_2+P_on_mos_sic_2;
    p_tot_mosfet_3=P_sl_mosfet_sic_3+P_on_mos_sic_3;
    p_tot_mosfet_5=P_sl_mosfet_sic_5+P_on_mos_sic_5;
    p_tot_mosfet_6=P_sl_mosfet_sic_6+P_on_mos_sic_6;

    p_tot_diode_10=P_sl_diode_sic_10+P_on_diode_sic_10;
    p_tot_diode_7=P_sl_diode_sic_7+P_on_diode_sic_7;
    p_tot_diode_4=P_sl_diode_sic_4+P_on_diode_sic_4;
    p_tot_diode_2=P_sl_diode_sic_2+P_on_diode_sic_2;
    p_tot_diode_3=P_sl_diode_sic_3+P_on_diode_sic_3;
    p_tot_diode_5=P_sl_diode_sic_5+P_on_diode_sic_5;
    p_tot_diode_6=P_sl_diode_sic_6+P_on_diode_sic_6;


    p_tot_sic_sic_10=p_tot_mosfet_10+p_tot_diode_10;
    p_tot_sic_sic_7=p_tot_mosfet_7+p_tot_diode_7;
    p_tot_sic_sic_4=p_tot_mosfet_4+p_tot_diode_4;
    p_tot_sic_sic_2=p_tot_mosfet_2+p_tot_diode_2;
    p_tot_sic_sic_3=p_tot_mosfet_3+p_tot_diode_3;
    p_tot_sic_sic_5=p_tot_mosfet_5+p_tot_diode_5;
    p_tot_sic_sic_6=p_tot_mosfet_6+p_tot_diode_6;
  
    
    total_s_loss_mos_di_10(counter)=P_sl_diode_sic_10+P_sl_mosfet_sic_10;
    total_mos_diode_losses_10(counter)=p_tot_sic_sic_10; 
    
    total_s_loss_mos_di_7(counter)=P_sl_diode_sic_7+P_sl_mosfet_sic_7;
    total_mos_diode_losses_7(counter)=p_tot_sic_sic_7; 
    
    total_s_loss_mos_di_4(counter)=P_sl_diode_sic_4+P_sl_mosfet_sic_4;
    total_mos_diode_losses_4(counter)=p_tot_sic_sic_4; 
    
    total_s_loss_mos_di_2(counter)=P_sl_diode_sic_2+P_sl_mosfet_sic_2;
    total_mos_diode_losses_2(counter)=p_tot_sic_sic_2; 
    
    total_s_loss_mos_di_3(counter)=P_sl_diode_sic_3+P_sl_mosfet_sic_3;
    total_mos_diode_losses_3(counter)=p_tot_sic_sic_3; 
    
    total_s_loss_mos_di_5(counter)=P_sl_diode_sic_5+P_sl_mosfet_sic_5;
    total_mos_diode_losses_5(counter)=p_tot_sic_sic_5; 
    
    total_s_loss_mos_di_6(counter)=P_sl_diode_sic_6+P_sl_mosfet_sic_6;
    total_mos_diode_losses_6(counter)=p_tot_sic_sic_6; 
    
    
    counter=counter+1; 
end

%---------------------------------------------------------------------------------------%
%Inductor losses (imported from inductor design) for 2A to 7A load current. Losses are core losses + winding losses
total_inductor_losses_Jrms2=[66.75789836097397, 64.75368933700379, 62.93542270508557, 61.22061191767614, 59.67842443968341, 58.22977428637061, 56.90691679884769, 55.6702179117663, 54.51685215469364, 53.44419805621341, 52.44983195633406, 51.49784185622926, 50.62047410584931, 49.78271192429821, 48.98359831300887, 48.2547440806856, 47.56227780393582, 46.873385506151045, 46.25165395660117, 45.66413282245215, 45.11019096186192, 44.55798665890908, 44.03856551398603, 43.582301476503176, 43.095943231005066, 42.67178113914498, 42.247982825440396, 41.854897677360896, 41.461897692962225, 41.099100578706945, 40.73614053446144, 40.402927013520625, 40.06933118334766, 39.76507793246082, 39.48990477089841, 39.184412508335015, 38.90783441199609, 38.6599439731384, 38.41117262997907, 38.16151925663688, 37.94023668520987, 37.7179570453476, 37.49468026126931, 37.29951757541749, 37.07419688197043, 36.905929100718765, 36.707505128883966, 36.53695707265535, 36.365255854032796, 36.19240270112648, 36.04728384192621, 35.87210182218363, 35.72460941907633, 35.60475379767716, 35.454857385485866, 35.3325758360261, 35.2090798819061, 35.08437068468633, 34.95845005339447, 34.83132042269696, 34.731760108092246, 34.63098938444913, 34.52900934195902, 34.42582158792728, 34.321428230448994, 34.21583186268202, 34.13783574505294, 34.0586554029223, 33.97829186982216, 33.89674658175369, 33.814021365373776, 33.730118426585406, 33.67392846644714, 33.58768681098038, 33.52919635754624, 33.46956986141013, 33.40880851112517, 33.34691379329501, 33.28388748453455, 33.21973164368295, 33.1544486042574, 33.117125091727175, 33.07873170043126, 33.01011673152037, 32.969552690113446, 32.92792202808692, 32.88522601485721, 32.8414661318515, 32.7966440673093, 32.7800995073785, 32.7331870461896, 32.68521784371453, 32.665631697957515, 32.61558228430826, 32.59398895737476, 32.57141507026685, 32.54786146773257, 32.52332914737431, 32.49781925625168, 32.47133308757297, 32.443872077472044, 32.41543780186758, 32.38603197340177, 32.38553238895964, 32.35422462808555, 32.3519152248328, 32.318711037929624, 32.31459508406039, 32.309603048147466, 32.303735444969746, 32.26678997194736, 32.259123734531464, 32.250584725386176, 32.24117386664901, 32.23089217662016, 32.219740767882676, 32.20772084546555, 32.194833705047984, 32.21166142038305, 32.19708839844902, 32.212340077478125, 32.19608484589768, 32.17896885769328, 32.191828995924624, 32.17303812440972, 32.18432801923462, 32.16386749225386, 32.17359026450467, 32.182560150184415, 32.19077757926843, 32.167033118369936];

total_inductor_losses_Jrms3=[105.12184462184109, 101.63966599104636, 98.4277754336386, 95.47321600508128, 92.7640442705066, 90.22740701869108, 87.85627430884911, 85.64406568592119, 83.58463478342085, 81.67225513635213, 79.90160713069227, 78.21115964406863, 76.5984572430014, 75.0611573040602, 73.6515564636943, 72.3117593285283, 71.03982941323432, 69.78113181531596, 68.64004270030404, 67.50981245463299, 66.49287008425375, 65.48467470384155, 64.53553063043157, 63.59411635415205, 62.7099016028288, 61.881613329984155, 61.05928091046175, 60.29126739579621, 59.52840057247455, 58.81836549894163, 58.16014635908644, 57.505672051262714, 56.854918995979034, 56.25439520390583, 55.65697076682471, 55.0626274837686, 54.5170717404221, 53.9740357644784, 53.47874977485709, 52.98547744285757, 52.494206652782474, 52.004926439440204, 51.56198769382712, 51.1205904937535, 50.724707115511194, 50.28616478476877, 49.892740191730375, 49.50044530429467, 49.152541907648825, 48.762309146119335, 48.416123814836055, 48.070712486837316, 47.72607044902193, 47.424688837191475, 47.081417824036905, 46.78111361744918, 46.4812772351908, 46.1819054325122, 45.924834041851305, 45.62625087500443, 45.36972306228084, 45.11340917795282, 44.85730678702171, 44.60141383753046, 44.34572864843916, 44.13132776787967, 43.8759438774287, 43.661646004136486, 43.44735449340238, 43.2330678566426, 43.01878489267835, 42.80450467935641, 42.63069874510206, 42.4163338483393, 42.242290375137586, 42.02783824155737, 41.85355368575308, 41.679115445534904, 41.50452282105741, 41.32977531837875, 41.15487264399615, 41.01967832973232, 40.844397999344466, 40.708716868748496, 40.533057992452505, 40.3968879413861, 40.26045145198866, 40.12374801727154, 39.986777279608354, 39.84953902713846, 39.71203319027198, 39.57425983829253, 39.43621917605369, 39.297911540765796, 39.19860143745646, 39.059713920304056, 38.95975563699251, 38.82028916147728, 38.71968224693718, 38.618739638853995, 38.51746110669777, 38.41584651949261, 38.2748664111936, 38.172604439281045, 38.10898656677525, 38.00602836725549, 37.90273487840501, 37.79910652365732, 37.69514381215569, 37.629721012620365, 37.525063591751945, 37.458917741042704, 37.35356682059958, 37.286697737158974, 37.180655126506494, 37.113063198972156, 37.04510843502269, 36.93801744860148, 36.8693410285084, 36.80030204554328, 36.730900581852005, 36.66113677829112, 36.591010833345074, 36.52052300206682, 36.449673595041205, 36.37846297737046, 36.30689156768107, 36.23495983715142, 36.20137255248589, 36.12871306766396, 36.055694564983];

total_inductor_losses_Jrms4=[147.74274200027446, 142.5860763871462, 137.9415896784576, 133.6858694033643, 129.705459356947, 125.98827469567581, 122.52299497604496, 119.38869063812896, 116.30652977620917, 113.53629032644123, 110.89425771758053, 108.37617692519824, 105.97798439402152, 103.77775391440733, 101.68768591298293, 99.70440557544086, 97.74577303302249, 95.96752339300235, 94.28688352249354, 92.6248306864737, 91.05667770562157, 89.57986673901716, 88.11804317438576, 86.74429234592681, 85.45636191144939, 84.18027414760921, 82.9871505951865, 81.80442636540249, 80.70201416072415, 79.60866869627901, 78.52433943445385, 77.58553176924576, 76.58568113937676, 75.66084156074385, 74.74268051286961, 73.89745950252242, 73.05789487587737, 72.22395822539043, 71.46058642398228, 70.70191806433851, 69.94793040103733, 69.19860161765763, 68.5172549318445, 67.839738952782, 67.2286716543253, 66.55839242742087, 65.95382280079404, 65.35231338681105, 64.75385082719265, 64.21939013588225, 63.687324976895056, 63.097264399283205, 62.570251905358276, 62.045603845200844, 61.58281118765402, 61.062571570121904, 60.60362286656252, 60.1464571521888, 59.691067181264565, 59.29567423155139, 58.843561270582576, 58.45096240952539, 58.00210194447516, 57.612274040081, 57.2237156457967, 56.836421858062096, 56.45038804774909, 56.12207068319603, 55.73832768896551, 55.41189829509761, 55.08631781136608, 54.7615825970616, 54.38215945281385, 54.11463446715683, 53.79241530561117, 53.471028910197816, 53.15047264145122, 52.88541538536973, 52.56633254168661, 52.30242243443764, 52.039011309330355, 51.77609690471369, 51.51367710601937, 51.25174994201235, 50.99031358115343, 50.72936632806923, 50.46890662012543, 50.26217685108053, 50.002544275523604, 49.796388790468605, 49.53757779526346, 49.331990679782486, 49.0739966295271, 48.868972841529306, 48.66417536622717, 48.45960303021163, 48.255254754256, 48.0511295511974, 47.847226523873545, 47.64354486311353, 47.49185548600878, 47.2885054343739, 47.085374592877315, 46.93394395271733, 46.73114041996125, 46.57985404708295, 46.37737555419079, 46.226230512754505, 46.07511869632259, 45.873069263099254, 45.722095145882726, 45.57115236700929, 45.420240340119605, 45.26935853682928, 45.1185064855961, 44.96768377061331, 44.81689003072814, 44.66612495838456, 44.51538829858984, 44.36467984790393, 44.26414765221377, 44.11341899240618, 43.96271797343462, 43.86200130341959, 43.711278606288104, 43.6104238822225, 43.45967880675757, 43.358684517908, 43.20791670475917, 43.106781662952805, 42.95599108146886];

total_inductor_losses_Jrms5=[193.45595341262327, 186.751492207073, 180.47393304727086, 174.73636562072073, 169.51171586014064, 164.51871892666202, 160.00038922678706, 155.687653516147, 151.6946389708657, 147.8886330343865, 144.4985440354397, 141.0434914982572, 137.87101747777348, 134.85787140006897, 131.99883123950048, 129.39855955941678, 126.83167082564346, 124.4047994874749, 122.11370651325214, 119.84998482117865, 117.71658859401602, 115.70975786521423, 113.82595162323832, 111.961906752087, 110.21638050828145, 108.48832871717899, 106.87460177774501, 105.27623294232058, 103.78829605123201, 102.31376387320904, 100.94606126142409, 99.58996595180702, 98.24541746750901, 97.00352535801119, 95.77154022071139, 94.63917518949313, 93.42612988440473, 92.31121449395792, 91.29238058478398, 90.28056138901171, 89.18918931046835, 88.27783924906959, 87.28687426829553, 86.3875766736283, 85.4939924921282, 84.60609747481408, 83.8070649152593, 82.9299353009763, 82.14059483761127, 81.35582798737501, 80.73817667752446, 79.880712309557, 79.26981320594052, 78.50171912107703, 77.81760228649236, 77.13705393929209, 76.46006101883984, 75.78661081226204, 75.1945320667232, 74.60517895162072, 74.01854156990967, 73.43461030750238, 72.8533758241253, 72.27482904451882, 71.77464618363754, 71.27645369711163, 70.70518590154428, 70.21126579859424, 69.71931507201587, 69.2293272490063, 68.74129605398207, 68.32871347481716, 67.84426630167, 67.43468699743696, 66.953802100671, 66.54720593898126, 66.14196534183544, 65.66623103960887, 65.2639459449655, 64.93433380985611, 64.53447304656245, 64.13594732616711, 63.738752946001576, 63.413241250160496, 63.0184423934125, 62.694858575909294, 62.302442391097635, 61.98077439499459, 61.65995790653436, 61.33999026955027, 61.02086892314637, 60.702591399448096, 60.38515532141557, 60.068558400716725, 59.75279843565824, 59.43787330917203, 59.19142832696603, 58.87796276482004, 58.565326192948234, 58.32060338879154, 58.00941538305311, 57.7657810153576, 57.5226120548805, 57.21348259520591, 56.97139256700665, 56.72976341183115, 56.488593720650286, 56.247882141976326, 56.00762738068681, 55.76782819687658, 55.52848340473728, 55.28959187146322, 55.05115251618291, 54.813164308915205, 54.640366032994706, 54.40312367736891, 54.16632959945855, 53.9943129542048, 53.75825915948718, 53.586724584709984, 53.351407742235764, 53.18035168976022, 53.00948211595144, 52.77518804077124, 52.604792148371914, 52.37122803572905, 52.20130304274463, 52.09470581142998, 51.86200036598356, 51.629734915785875, 51.52342291267824];

total_inductor_losses_Jrms6=[241.8473972112056, 233.35881564720694, 225.42535135265302, 218.19442679331365, 211.45945777169652, 205.364980420463, 199.55167071176197, 194.17039532069538, 189.04403810673966, 184.31926384289645, 179.8261795363677, 175.55664484701546, 171.65173144701134, 167.80419671509398, 164.30276747793414, 160.84950456950378, 157.58479187127008, 154.5026208004281, 151.59730657500373, 148.86348016428605, 146.1619870947601, 143.625112413418, 141.11705552652256, 138.76720423102208, 136.57114363511872, 134.3977533419731, 132.37257233602293, 130.36725314286576, 128.38168569675588, 126.53782364635072, 124.71113954536037, 123.02140801035718, 121.34649115254747, 119.80415455162012, 118.27447126239075, 116.75738026610367, 115.25282146879877, 113.87480055800316, 112.50736146535147, 111.150456270636, 109.91555169285144, 108.57870356200743, 107.47203188405686, 106.26334166525643, 105.06331556393502, 103.97955681201233, 102.90289915681434, 101.83331411192316, 100.87636649484756, 99.82014002261562, 98.87516739063057, 97.9358342228942, 97.00211935637077, 96.07400198894373, 95.25330053928413, 94.33569681993211, 93.5243037502594, 92.71726696463307, 91.91457125183445, 91.11620167270398, 90.42071263319721, 89.63041061232141, 88.94195231004846, 88.15966552504989, 87.47819050138796, 86.79995695854481, 86.12495453586368, 85.54840319150998, 84.87936925881405, 84.21353732366072, 83.64481034167876, 82.9848925765004, 82.42121046091417, 81.85984432984708, 81.30078724028864, 80.74403238961287, 80.18957311171687, 79.6374028732833, 79.17831608250582, 78.63031833274312, 78.0845913220661, 77.63084106765467, 77.1786486343237, 76.63892900028756, 76.19015401410006, 75.74292324142277, 75.29723245167008, 74.85307750647473, 74.41045435743922, 73.96935904395171, 73.52978769106316, 73.09173650742363, 72.74145646574776, 72.30612218003219, 71.95799576002379, 71.61081974029163, 71.17938066168418, 70.7494415632327, 70.40558738197689, 70.06267280292593, 69.72069536202771, 69.2957932925034, 68.95592561588369, 68.61698788617348, 68.27897786912807, 67.94189338446583, 67.6057323047349, 67.3528982117186, 67.0183359760204, 66.6846912059333, 66.35196197300029, 66.10165274074919, 65.77050767505095, 65.44027277385223, 65.1917959677017, 64.86313522042695, 64.61581427400299, 64.36898205690353, 64.04255066058242, 63.79686584780897, 63.55166576253568, 63.227451106125386, 62.98339062571354, 62.73981118347178, 62.49671162296488, 62.254090819111205, 62.0119476776238, 61.77028113446333, 61.52909015530241, 61.28837373500107, 61.048130897093046];

%---------------------------------------------------------------------------------------%
%Total MOSFET, DIODE and INDUCTOR losses
total_losses_inductor_mos_di=total_inductor_losses_Jrms2./6....
    +((total_mos_diode_losses_7+total_mos_diode_losses_4+total_mos_diode_losses_2+...
    total_mos_diode_losses_3+total_mos_diode_losses_5+total_mos_diode_losses_6)./6)';
%---------------------------------------------------------------------------------------%
figure(1)
plot(frequencies/1000,total_losses_inductor_mos_di,'LineWidth',3)
[Min,I]=min(total_losses_inductor_mos_di);
hold on
disp(Min)
disp(frequencies(I))

total_losses_inductor_mos_di=total_inductor_losses_Jrms3./6....
    +((total_mos_diode_losses_7+total_mos_diode_losses_4+total_mos_diode_losses_2+...
    total_mos_diode_losses_3+total_mos_diode_losses_5+total_mos_diode_losses_6)./6)';

%figure(2)
plot(frequencies/1000,total_losses_inductor_mos_di,'LineWidth',3)
disp(Min)
disp(frequencies(I))

total_losses_inductor_mos_di=total_inductor_losses_Jrms4./6....
    +((total_mos_diode_losses_7+total_mos_diode_losses_4+total_mos_diode_losses_2+...
    total_mos_diode_losses_3+total_mos_diode_losses_5+total_mos_diode_losses_6)./6)';

%figure(3)
plot(frequencies/1000,total_losses_inductor_mos_di,'LineWidth',3)
disp(Min)
disp(frequencies(I))

total_losses_inductor_mos_di=total_inductor_losses_Jrms5./6....
    +((total_mos_diode_losses_7+total_mos_diode_losses_4+total_mos_diode_losses_2+...
    total_mos_diode_losses_3+total_mos_diode_losses_5+total_mos_diode_losses_6)./6)';

%figure(4)
plot(frequencies/1000,total_losses_inductor_mos_di,'LineWidth',3)
disp(Min)
disp(frequencies(I))

total_losses_inductor_mos_di=total_inductor_losses_Jrms6./6....
    +((total_mos_diode_losses_7+total_mos_diode_losses_4+total_mos_diode_losses_2+...
    total_mos_diode_losses_3+total_mos_diode_losses_5+total_mos_diode_losses_6)./6)';

%figure(5)
plot(frequencies/1000,total_losses_inductor_mos_di,'LineWidth',3)
plot(frequencies(I)/1000, Min,'r*','LineWidth',5)
grid on
xlabel('Switching frequency [kHz]','FontSize',20)
ylabel('Power losses [W]','FontSize',20)
legend({'11.8 mm2','7.9 mm2','5.9 mm2','4.7 mm2','3.9mm2', 'Minimum losses (fs= 53 kHz)'},'FontSize',16)
disp(Min)
disp(frequencies(I))
